from advanced_report_generator import AdvancedExcelRenderer

# –î–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç—á–µ—Ç–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Å–≤–æ—Ä–∞—á–∏–≤–∞–µ–º—ã—Ö —Å—Ç—Ä–æ–∫
data = {
    "title": "–û—Ç—á–µ—Ç –æ—Ç 12221",
    "subtitle": "–ü–µ—Ä–∏–æ–¥: 01.01.2024 - 31.12.2024",
    "summary": {
        "total_revenue": 1000000,
        "total_orders": 500,
        "avg_order_value": 2000
    },
    "sections": [
        {
            "title": "–ü—Ä–æ–¥–∞–∂–∏ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º",
            "type": "table",
            "collapsed": False,
            "data": [
                {"region": "–ú–æ—Å–∫–≤–∞", "sales": 500000, "orders": 250, "growth": 15.2},
                {"region": "–°–ü–±", "sales": 300000, "orders": 150, "growth": 8.7},
                {"region": "–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥", "sales": 150000, "orders": 75, "growth": 12.1},
                {"region": "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫", "sales": 50000, "orders": 25, "growth": 5.3},
            ]
        },
        {
            "title": "–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º",
            "type": "grouped_data",
            "collapsed": True,  # –≠—Ç–∞ —Å–µ–∫—Ü–∏—è –±—É–¥–µ—Ç —Å–≤–µ—Ä–Ω—É—Ç–∞
            "groups": [
                {
                    "title": "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞",
                    "collapsed": False,
                    "data": [
                        {"product": "–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã", "sales": 200000, "units": 100, "margin": 25.5},
                        {"product": "–ù–æ—É—Ç–±—É–∫–∏", "sales": 150000, "units": 50, "margin": 18.2},
                        {"product": "–ü–ª–∞–Ω—à–µ—Ç—ã", "sales": 100000, "units": 80, "margin": 22.1}
                    ]
                },
                {
                    "title": "–û–¥–µ–∂–¥–∞",
                    "collapsed": True,  # –≠—Ç–∞ –≥—Ä—É–ø–ø–∞ –±—É–¥–µ—Ç —Å–≤–µ—Ä–Ω—É—Ç–∞
                    "data": [
                        {"product": "–ö—É—Ä—Ç–∫–∏", "sales": 80000, "units": 160, "margin": 45.2},
                        {"product": "–î–∂–∏–Ω—Å—ã", "sales": 60000, "units": 120, "margin": 38.5},
                        {"product": "–§—É—Ç–±–æ–ª–∫–∏", "sales": 40000, "units": 200, "margin": 52.1}
                    ]
                },
                {
                    "title": "–ö–Ω–∏–≥–∏",
                    "collapsed": False,
                    "data": [
                        {"product": "–•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞", "sales": 30000, "units": 300, "margin": 35.2},
                        {"product": "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞", "sales": 25000, "units": 125, "margin": 28.5},
                        {"product": "–î–µ—Ç—Å–∫–∏–µ –∫–Ω–∏–≥–∏", "sales": 15000, "units": 150, "margin": 42.1}
                    ]
                }
            ]
        },
        {
            "title": "–î–∏–Ω–∞–º–∏–∫–∞ –ø—Ä–æ–¥–∞–∂ –ø–æ –º–µ—Å—è—Ü–∞–º",
            "type": "chart",
            "chart_type": "line",
            "collapsed": False,
            "data": [
                {"month": "–Ø–Ω–≤–∞—Ä—å", "sales": 80000, "orders": 40},
                {"month": "–§–µ–≤—Ä–∞–ª—å", "sales": 85000, "orders": 42},
                {"month": "–ú–∞—Ä—Ç", "sales": 90000, "orders": 45},
                {"month": "–ê–ø—Ä–µ–ª—å", "sales": 95000, "orders": 48},
                {"month": "–ú–∞–π", "sales": 100000, "orders": 50},
                {"month": "–ò—é–Ω—å", "sales": 105000, "orders": 52}
            ]
        },
        {
            "title": "–ü–æ–¥—Ä–æ–±–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏",
            "type": "table",
            "collapsed": True,  # –≠—Ç–∞ —Å–µ–∫—Ü–∏—è –±—É–¥–µ—Ç —Å–≤–µ—Ä–Ω—É—Ç–∞
            "data": [
                {"transaction_id": "TXN-001", "date": "15.01.2024", "amount": 5000, "customer": "–ö–ª–∏–µ–Ω—Ç –ê", "status": "–í—ã–ø–æ–ª–Ω–µ–Ω"},
                {"transaction_id": "TXN-002", "date": "16.01.2024", "amount": 3500, "customer": "–ö–ª–∏–µ–Ω—Ç –ë", "status": "–í—ã–ø–æ–ª–Ω–µ–Ω"},
                {"transaction_id": "TXN-003", "date": "17.01.2024", "amount": 7200, "customer": "–ö–ª–∏–µ–Ω—Ç –í", "status": "–í –æ–±—Ä–∞–±–æ—Ç–∫–µ"},
                {"transaction_id": "TXN-004", "date": "18.01.2024", "amount": 2800, "customer": "–ö–ª–∏–µ–Ω—Ç –ì", "status": "–í—ã–ø–æ–ª–Ω–µ–Ω"},
                {"transaction_id": "TXN-005", "date": "19.01.2024", "amount": 4100, "customer": "–ö–ª–∏–µ–Ω—Ç –î", "status": "–û—Ç–º–µ–Ω–µ–Ω"},
                {"transaction_id": "TXN-006", "date": "20.01.2024", "amount": 6300, "customer": "–ö–ª–∏–µ–Ω—Ç –ï", "status": "–í—ã–ø–æ–ª–Ω–µ–Ω"},
                {"transaction_id": "TXN-007", "date": "21.01.2024", "amount": 1900, "customer": "–ö–ª–∏–µ–Ω—Ç –ñ", "status": "–í –æ–±—Ä–∞–±–æ—Ç–∫–µ"},
                {"transaction_id": "TXN-008", "date": "22.01.2024", "amount": 8500, "customer": "–ö–ª–∏–µ–Ω—Ç –ó", "status": "–í—ã–ø–æ–ª–Ω–µ–Ω"}
            ]
        }
    ]
}


if __name__ == "__main__":
    # –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞
    print("üöÄ –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞ —Å–æ —Å–≤–æ—Ä–∞—á–∏–≤–∞–µ–º—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏...")
    renderer = AdvancedExcelRenderer()
    workbook = renderer.create_collapsible_report(data)
    renderer.save_report("my_report.xlsx")
    print("‚úÖ –û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω: my_report.xlsx")
    print("\nüìã –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è:")
    print("  ‚Ä¢ –°–µ–∫—Ü–∏—è '–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º' - —Å–≤–µ—Ä–Ω—É—Ç–∞ (–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)")
    print("  ‚Ä¢ –ì—Ä—É–ø–ø–∞ '–û–¥–µ–∂–¥–∞' –≤–Ω—É—Ç—Ä–∏ –∞–Ω–∞–ª–∏–∑–∞ - —Å–≤–µ—Ä–Ω—É—Ç–∞")
    print("  ‚Ä¢ –°–µ–∫—Ü–∏—è '–ü–æ–¥—Ä–æ–±–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏' - —Å–≤–µ—Ä–Ω—É—Ç–∞")
    print("  ‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ ‚ñº/‚ñ∂ –¥–ª—è —Å–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è/—Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è")
    print("  ‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ (1, 2, 3) —Å–ª–µ–≤–∞ –æ—Ç —Å—Ç—Ä–æ–∫")