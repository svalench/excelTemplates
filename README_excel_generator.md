# Excel –®–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä

–ú–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ Excel –æ—Ç—á–µ—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —à–∞–±–ª–æ–Ω–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Jinja2.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Jinja2 —Å–∏–Ω—Ç–∞–∫—Å–∏—Å `{{variable}}`
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤—Å—Ç–∞–≤–∫–∞ —Ç–∞–±–ª–∏—Ü –∏–∑ DataFrame –∏–ª–∏ —Å–ø–∏—Å–∫–æ–≤ —Å–ª–æ–≤–∞—Ä–µ–π
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ `{{object.property}}`
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Excel
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å JSON –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ PDF (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ LibreOffice)
- ‚úÖ –í—Å—Ç–∞–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- ‚úÖ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å—Ç—Ä–æ–∫ (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install pandas openpyxl jinja2 requests
```

## üéØ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞

–°–æ–∑–¥–∞–π—Ç–µ Excel —Ñ–∞–π–ª —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ Jinja2:

```excel
A1: {{report_title}}
A2: –î–∞—Ç–∞: {{report_date}}
A4: –í—Å–µ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: {{summary.total_employees}}
A5: –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞: {{summary.avg_salary}} —Ä—É–±.

A10: {{departments_start}}  # –ú–∞—Ä–∫–µ—Ä –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã
A15: {{employees_start}}    # –ú–∞—Ä–∫–µ—Ä –¥–ª—è –¥—Ä—É–≥–æ–π —Ç–∞–±–ª–∏—Ü—ã
```

### 2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```python
data = {
    "report_title": "–û—Ç—á–µ—Ç –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º",
    "report_date": "28.05.2024",
    "summary": {
        "total_employees": 6,
        "avg_salary": 65000
    },
    "departments": [
        {"name": "IT –æ—Ç–¥–µ–ª", "count": 3, "avg_salary": 80000},
        {"name": "–ü—Ä–æ–¥–∞–∂–∏", "count": 2, "avg_salary": 50000}
    ],
    "employees": [
        {"name": "–ò–≤–∞–Ω", "position": "–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫", "salary": 90000},
        {"name": "–ú–∞—Ä–∏—è", "position": "–ú–µ–Ω–µ–¥–∂–µ—Ä", "salary": 60000}
    ]
}
```

### 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞

```python
from excel_gen import generate_report

# –ò–∑ —Å–ª–æ–≤–∞—Ä—è
output_file = generate_report("my_template", data, "xlsx")

# –ò–∑ JSON —Å—Ç—Ä–æ–∫–∏
import json
json_data = json.dumps(data)
output_file = generate_report("my_template", json_data, "xlsx")

print(f"–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω: {output_file}")
```

## üìã –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

| –¢–∏–ø | –ü—Ä–∏–º–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|--------|----------|
| –ü—Ä–æ—Å—Ç–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è | `{{title}}` | –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è |
| –í–ª–æ–∂–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç | `{{user.name}}` | –î–æ—Å—Ç—É–ø –∫ —Å–≤–æ–π—Å—Ç–≤—É –æ–±—ä–µ–∫—Ç–∞ |
| –°—Å—ã–ª–∫–∞ | `{{website_url}}` | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≥–∏–ø–µ—Ä—Å—Å—ã–ª–∫–æ–π |

### –í—Å—Ç–∞–≤–∫–∞ —Ç–∞–±–ª–∏—Ü

–î–ª—è –≤—Å—Ç–∞–≤–∫–∏ —Ç–∞–±–ª–∏—Ü –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∞—Ä–∫–µ—Ä—ã `{{table_name_start}}`:

1. **–í —à–∞–±–ª–æ–Ω–µ**: –ø–æ–º–µ—Å—Ç–∏—Ç–µ `{{departments_start}}` –≤ —è—á–µ–π–∫—É
2. **–í –¥–∞–Ω–Ω—ã—Ö**: –ø–µ—Ä–µ–¥–∞–π—Ç–µ —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π –∏–ª–∏ DataFrame:

```python
data = {
    "departments": [
        {"name": "IT", "employees": 5},
        {"name": "Sales", "employees": 3}
    ]
}
```

–¢–∞–±–ª–∏—Ü–∞ –±—É–¥–µ—Ç –≤—Å—Ç–∞–≤–ª–µ–Ω–∞ –Ω–∞—á–∏–Ω–∞—è —Å —è—á–µ–π–∫–∏ —Å –º–∞—Ä–∫–µ—Ä–æ–º.

### –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

| Python —Ç–∏–ø | Excel —Ä–µ–∑—É–ª—å—Ç–∞—Ç |
|------------|-----------------|
| `str` | –¢–µ–∫—Å—Ç |
| `int`, `float` | –ß–∏—Å–ª–æ |
| `list[dict]` | –¢–∞–±–ª–∏—Ü–∞ |
| `pd.DataFrame` | –¢–∞–±–ª–∏—Ü–∞ |
| URL —Å—Ç—Ä–æ–∫–∞ | –ì–∏–ø–µ—Ä—Å—Å—ã–ª–∫–∞ |

## üõ†Ô∏è API Reference

### `generate_report(template_name, json_data, output_format='xlsx')`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `template_name` (str): –ò–º—è —Ñ–∞–π–ª–∞ —à–∞–±–ª–æ–Ω–∞ –±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- `json_data` (str|dict): –î–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON —Å—Ç—Ä–æ–∫–∏ –∏–ª–∏ —Å–ª–æ–≤–∞—Ä—è
- `output_format` (str): –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ ('xlsx' –∏–ª–∏ 'pdf')

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** –ü—É—Ç—å –∫ —Å–æ–∑–¥–∞–Ω–Ω–æ–º—É —Ñ–∞–π–ª—É

### `create_simple_report(title, data_dict, output_path=None)`

–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –±–µ–∑ —à–∞–±–ª–æ–Ω–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `title` (str): –ó–∞–≥–æ–ª–æ–≤–æ–∫ –æ—Ç—á–µ—Ç–∞
- `data_dict` (dict): –î–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç—á–µ—Ç–∞
- `output_path` (str, optional): –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

## üìä –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–π –æ—Ç—á–µ—Ç

```python
from excel_gen import create_simple_report

data = {
    "total_sales": 150000,
    "products": [
        {"name": "–¢–æ–≤–∞—Ä –ê", "sales": 50000},
        {"name": "–¢–æ–≤–∞—Ä –ë", "sales": 100000}
    ]
}

report_path = create_simple_report("–û—Ç—á–µ—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º", data)
print(f"–ü—Ä–æ—Å—Ç–æ–π –æ—Ç—á–µ—Ç: {report_path}")
```

### –ü—Ä–∏–º–µ—Ä 2: –°–ª–æ–∂–Ω—ã–π —à–∞–±–ª–æ–Ω

```python
from excel_gen import generate_report
import json

# –°–ª–æ–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
complex_data = {
    "company": "–û–û–û –†–æ–≥–∞ –∏ –ö–æ–ø—ã—Ç–∞",
    "period": "Q1 2024",
    "metrics": {
        "revenue": 1500000,
        "profit": 300000,
        "growth": 15.5
    },
    "departments": [
        {
            "name": "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞",
            "budget": 500000,
            "employees": [
                {"name": "–ê–ª–µ–∫—Å–µ–π", "role": "Senior Dev", "salary": 120000},
                {"name": "–ú–∞—Ä–∏—è", "role": "Junior Dev", "salary": 80000}
            ]
        }
    ]
}

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è
output = generate_report("quarterly_template", complex_data)
```

### –ü—Ä–∏–º–µ—Ä 3: –†–∞–±–æ—Ç–∞ —Å pandas

```python
import pandas as pd
from excel_gen import generate_report

# –°–æ–∑–¥–∞–Ω–∏–µ DataFrame
df_sales = pd.DataFrame({
    '–ú–µ—Å—è—Ü': ['–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç'],
    '–ü—Ä–æ–¥–∞–∂–∏': [100000, 120000, 110000],
    '–ü—Ä–∏–±—ã–ª—å': [20000, 25000, 22000]
})

data = {
    "report_title": "–ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç",
    "sales_data": df_sales,  # DataFrame –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç—Å—è
    "summary": {
        "total_sales": df_sales['–ü—Ä–æ–¥–∞–∂–∏'].sum(),
        "avg_profit": df_sales['–ü—Ä–∏–±—ã–ª—å'].mean()
    }
}

output = generate_report("sales_template", data)
```

## üîß –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)

```excel
{%excel image "company_logo"%}     # –í—Å—Ç–∞–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
{%excel group "2" "5" "1"%}        # –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å—Ç—Ä–æ–∫ 2-5, —É—Ä–æ–≤–µ–Ω—å 1
```

### –£—Å–ª–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ Jinja2

```excel
{% if summary.profit > 0 %}
–ü—Ä–∏–±—ã–ª—å: {{summary.profit}} —Ä—É–±.
{% else %}
–£–±—ã—Ç–æ–∫: {{summary.loss}} —Ä—É–±.
{% endif %}
```

### –¶–∏–∫–ª—ã Jinja2

```excel
{% for dept in departments %}
{{dept.name}}: {{dept.employee_count}} —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
{% endfor %}
```

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

1. **FileNotFoundError**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª —à–∞–±–ª–æ–Ω–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
2. **JSON –æ—à–∏–±–∫–∏**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å JSON –¥–∞–Ω–Ω—ã—Ö
3. **–ü—É—Å—Ç—ã–µ —è—á–µ–π–∫–∏**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–∞—Ä–∫–µ—Ä—ã —Ç–æ—á–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –∏–º–µ–Ω–∞–º –≤ –¥–∞–Ω–Ω—ã—Ö

### –û—Ç–ª–∞–¥–∫–∞

```python
# –í–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ –æ—à–∏–±–æ–∫
import traceback

try:
    output = generate_report("template", data)
except Exception as e:
    print(f"–û—à–∏–±–∫–∞: {e}")
    traceback.print_exc()
```

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
3. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. –°–æ–∑–¥–∞–π—Ç–µ Pull Request

---

**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–î–∞—Ç–∞:** 28.05.2024 